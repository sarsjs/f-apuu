# Pendientes del proyecto

1. **Publicar `.env.example` y purgar `catalogos/.env`.** El repositorio incluye una clave real de Gemini dentro de `catalogos/.env`. Se necesita un `.env.example` con `GEMINI_API_KEY`, `GEMINI_MODEL` y `PRECIOS_OBSOLETOS_DIAS`, y la version real debe dejarse fuera del control de versiones para no exponer secretos.
2. **Dividir `catalogos/app.py` en modulos.** Toda la configuracion, modelos, helpers, rutas REST, heuristicas de IA y generacion de PDF viven en un archivo de ~2.000 lineas. Separar modelos, servicios y blueprints (`models.py`, `services.py`, `routes/catalogos.py`, etc.) facilitara el mantenimiento y la escritura de pruebas.
3. **Aumentar la cobertura de pruebas.** `catalogos/test_app.py` solo cubre `calcular_pu` y `match_mano_obra`. Faltan pruebas para los endpoints CRUD, los flujos de presupuestos, la actualizacion masiva de precios, las rutas de IA y la generacion de notas de venta.
4. **Centralizar el manejo de errores y cargas en el frontend.** `apiFetch` no atrapa excepciones y componentes como `PresupuestoManager`, `CatalogosDashboard` o `AnalisisPuPage` dependen de `alert`/`console.error`. Hace falta un contexto de UI o un hook que exponga estados `loading/error` y UI consistentes (toasts, mensajes inline).
5. **Parametrizar CORS y las bases de URL.** El backend solo permite `http://localhost:3000` y el frontend asume `http://localhost:8000/api` salvo que se recompile con otra `VITE_API_BASE_URL`. Se debe leer la lista de origenes desde variables de entorno y documentar mejor como apuntar a entornos remotos.
6. **Retirar o alinear `catalogos/models.py`.** Ese archivo contiene modelos de Django que ya no se usan. Deberia eliminarse, documentarse como referencia historica o migrarse para pruebas fuera de Flask, porque hoy genera confusion y no refleja el stack real.
7. **Convertir las utilidades simuladas en flujos reales.** El boton “Ejecutar Actualizacion Masiva (Simulada)” de `CatalogosDashboard` y varias alertas en `AnalisisPuPage` solo muestran escenarios estaticos. Se necesita una UI que permita cargar archivos/listas reales para `/api/catalogos/actualizar_precios_masivo`, asi como confirmaciones y mensajes reutilizables en vez de `alert`.
